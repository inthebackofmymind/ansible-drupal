--- # Install LAMP on Centos 7
- hosts: local
  remote_user: centos
  sudo: yes
  gather_facts: no
  connection: ssh
  tasks:
  - name: Install httpd
    yum: name=httpd state=latest
    notify: 
    - Restart httpd
  - name: Install mariadb
    yum: state=present name={{ item }}
    with_items:
    - mariadb
    - mariadb-server
    notify:
    - Installed mariadb
  - name: Install wget
    yum: state=present name=wget
  - name: Install php and related modules
    yum: state=present name={{ item }}
    with_items:
    - php
    - php-mysql
    - php-cli
    - php-pear
    - php-xml
    - php-mbstring
    - php-gd
    - php-common
    notify:
    - Restart httpd
  - name: Drupal download and extract 
    raw: rm -fr /var/www/html; cd /var/www; wget -O /var/www/drupal-7.50.tar.gz https://ftp.drupal.org/files/projects/drupal-7.50.tar.gz; tar xvfz /var/www/drupal-7.50.tar.gz; rm /var/www/drupal-7.50.tar.gz; mv /var/www/drupal-7.50 /var/www/html; mkdir /var/www/html/sites/default/files; cp /var/www/html/sites/default/default.settings.php /var/www/html/sites/default/settings.php; chmod -R 777 /var/www/html/sites/default
  handlers:
  - name: Restart httpd
    service: name=httpd state=restarted enabled=yes 
  - name: Installed mariadb
    service: name=mariadb state=restarted enabled=yes
